(function(e){"use strict";if(typeof bootstrap==="function"){bootstrap("promise",e)}else if(typeof exports==="object"&&typeof module==="object"){module.exports=e()}else if(typeof define==="function"&&define.amd){define(e)}else if(typeof ses!=="undefined"){if(!ses.ok()){return}else{ses.makeQ=e}}else if(typeof window!=="undefined"||typeof self!=="undefined"){var t=typeof window!=="undefined"?window:self;var n=t.Q;t.Q=e();t.Q.noConflict=function(){t.Q=n;return this}}else{throw new Error("This environment was not anticipated by Q. Please file a bug.")}})(function(){"use strict";var e=false;try{throw new Error}catch(t){e=!!t.stack}var n=R();var r;var o=function(){};var i=function(){var e={task:void 0,next:null};var t=e;var n=false;var r=void 0;var o=false;var u=[];function s(){var t,r;while(e.next){e=e.next;t=e.task;e.task=void 0;r=e.domain;if(r){e.domain=void 0;r.enter()}f(t,r)}while(u.length){t=u.pop();f(t)}n=false}function f(e,t){try{e()}catch(n){if(o){if(t){t.exit()}setTimeout(s,0);if(t){t.enter()}throw n}else{setTimeout(function(){throw n},0)}}if(t){t.exit()}}i=function(e){t=t.next={task:e,domain:o&&process.domain,next:null};if(!n){n=true;r()}};if(typeof process==="object"&&process.toString()==="[object process]"&&process.nextTick){o=true;r=function(){process.nextTick(s)}}else if(typeof setImmediate==="function"){if(typeof window!=="undefined"){r=setImmediate.bind(window,s)}else{r=function(){setImmediate(s)}}}else if(typeof MessageChannel!=="undefined"){var c=new MessageChannel;c.port1.onmessage=function(){r=a;c.port1.onmessage=s;s()};var a=function(){c.port2.postMessage(0)};r=function(){setTimeout(s,0);a()}}else{r=function(){setTimeout(s,0)}}i.runAfter=function(e){u.push(e);if(!n){n=true;r()}};return i}();var u=Function.call;function s(e){return function(){return u.apply(e,arguments)}}var f=s(Array.prototype.slice);var c=s(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(arguments.length===1){do{if(n in this){t=this[n++];break}if(++n>=r){throw new TypeError}}while(1)}for(;n<r;n++){if(n in this){t=e(t,this[n],n)}}return t});var a=s(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var p=s(Array.prototype.map||function(e,t){var n=this;var r=[];c(n,function(o,i,u){r.push(e.call(t,i,u,n))},void 0);return r});var l=Object.create||function(e){function t(){}t.prototype=e;return new t};var d=s(Object.prototype.hasOwnProperty);var h=Object.keys||function(e){var t=[];for(var n in e){if(d(e,n)){t.push(n)}}return t};var y=s(Object.prototype.toString);function v(e){return e===Object(e)}function m(e){return y(e)==="[object StopIteration]"||e instanceof g}var g;if(typeof ReturnValue!=="undefined"){g=ReturnValue}else{g=function(e){this.value=e}}var k="From previous event:";function w(t,n){if(e&&n.stack&&typeof t==="object"&&t!==null&&t.stack&&t.stack.indexOf(k)===-1){var r=[];for(var o=n;!!o;o=o.source){if(o.stack){r.unshift(o.stack)}}r.unshift(t.stack);var i=r.join("\n"+k+"\n");t.stack=b(i)}}function b(e){var t=e.split("\n");var n=[];for(var r=0;r<t.length;++r){var o=t[r];if(!x(o)&&!T(o)&&o){n.push(o)}}return n.join("\n")}function T(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function j(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n){return[n[1],Number(n[2])]}var r=/.*@(.+):(\d+)$/.exec(e);if(r){return[r[1],Number(r[2])]}}function x(e){var t=j(e);if(!t){return false}var o=t[0];var i=t[1];return o===r&&i>=n&&i<=fe}function R(){if(!e){return}try{throw new Error}catch(t){var n=t.stack.split("\n");var o=n[0].indexOf("@")>0?n[1]:n[2];var i=j(o);if(!i){return}r=i[0];return i[1]}}function E(e,t,n){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack)}return e.apply(e,arguments)}}function S(e){if(e instanceof P){return e}if(D(e)){return V(e)}else{return X(e)}}S.resolve=S;S.nextTick=i;S.longStackSupport=false;if(typeof process==="object"&&process&&process.env&&process.env.Q_DEBUG){S.longStackSupport=true}S.defer=O;function O(){var t=[],n=[],r;var o=l(O.prototype);var i=l(P.prototype);i.promiseDispatch=function(e,o,i){var u=f(arguments);if(t){t.push(u);if(o==="when"&&i[1]){n.push(i[1])}}else{S.nextTick(function(){r.promiseDispatch.apply(r,u)})}};i.valueOf=function(){if(t){return i}var e=N(r);if(U(e)){r=e}return e};i.inspect=function(){if(!r){return{state:"pending"}}return r.inspect()};if(S.longStackSupport&&e){try{throw new Error}catch(u){i.stack=u.stack.substring(u.stack.indexOf("\n")+1)}}function s(e){r=e;i.source=e;c(t,function(t,n){S.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0);t=void 0;n=void 0}o.promise=i;o.resolve=function(e){if(r){return}s(S(e))};o.fulfill=function(e){if(r){return}s(X(e))};o.reject=function(e){if(r){return}s(J(e))};o.notify=function(e){if(r){return}c(n,function(t,n){S.nextTick(function(){n(e)})},void 0)};return o}O.prototype.makeNodeResolver=function(){var e=this;return function(t,n){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(f(arguments,1))}else{e.resolve(n)}}};S.Promise=_;S.promise=_;function _(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=O();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}_.race=C;_.all=ne;_.reject=J;_.resolve=S;S.passByCopy=function(e){return e};P.prototype.passByCopy=function(){return this};S.join=function(e,t){return S(e).join(t)};P.prototype.join=function(e){return S([this,e]).spread(function(e,t){if(e===t){return e}else{throw new Error("Can't join: not the same: "+e+" "+t)}})};S.race=C;function C(e){return _(function(t,n){for(var r=0,o=e.length;r<o;r++){S(e[r]).then(t,n)}})}P.prototype.race=function(){return this.then(S.race)};S.makePromise=P;function P(e,t,n){if(t===void 0){t=function(e){return J(new Error("Promise does not support operation: "+e))}}if(n===void 0){n=function(){return{state:"unknown"}}}var r=l(P.prototype);r.promiseDispatch=function(n,o,i){var u;try{if(e[o]){u=e[o].apply(r,i)}else{u=t.call(r,o,i)}}catch(s){u=J(s)}if(n){n(u)}};r.inspect=n;if(n){var o=n();if(o.state==="rejected"){r.exception=o.reason}r.valueOf=function(){var e=n();if(e.state==="pending"||e.state==="rejected"){return r}return e.value}}return r}P.prototype.toString=function(){return"[object Promise]"};P.prototype.then=function(e,t,n){var r=this;var o=O();var i=false;function u(t){try{return typeof e==="function"?e(t):t}catch(n){return J(n)}}function s(e){if(typeof t==="function"){w(e,r);try{return t(e)}catch(n){return J(n)}}return J(e)}function f(e){return typeof n==="function"?n(e):e}S.nextTick(function(){r.promiseDispatch(function(e){if(i){return}i=true;o.resolve(u(e))},"when",[function(e){if(i){return}i=true;o.resolve(s(e))}])});r.promiseDispatch(void 0,"when",[void 0,function(e){var t;var n=false;try{t=f(e)}catch(r){n=true;if(S.onerror){S.onerror(r)}else{throw r}}if(!n){o.notify(t)}}]);return o.promise};S.tap=function(e,t){return S(e).tap(t)};P.prototype.tap=function(e){e=S(e);return this.then(function(t){return e.fcall(t).thenResolve(t)})};S.when=A;function A(e,t,n,r){return S(e).then(t,n,r)}P.prototype.thenResolve=function(e){return this.then(function(){return e})};S.thenResolve=function(e,t){return S(e).thenResolve(t)};P.prototype.thenReject=function(e){return this.then(function(){throw e})};S.thenReject=function(e,t){return S(e).thenReject(t)};S.nearer=N;function N(e){if(U(e)){var t=e.inspect();if(t.state==="fulfilled"){return t.value}}return e}S.isPromise=U;function U(e){return e instanceof P}S.isPromiseAlike=D;function D(e){return v(e)&&typeof e.then==="function"}S.isPending=I;function I(e){return U(e)&&e.inspect().state==="pending"}P.prototype.isPending=function(){return this.inspect().state==="pending"};S.isFulfilled=q;function q(e){return!U(e)||e.inspect().state==="fulfilled"}P.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};S.isRejected=L;function L(e){return U(e)&&e.inspect().state==="rejected"}P.prototype.isRejected=function(){return this.inspect().state==="rejected"};var Q=[];var H=[];var M=[];var G=true;function B(){Q.length=0;H.length=0;if(!G){G=true}}function F(e,t){if(!G){return}if(typeof process==="object"&&typeof process.emit==="function"){S.nextTick.runAfter(function(){if(a(H,e)!==-1){process.emit("unhandledRejection",t,e);M.push(e)}})}H.push(e);if(t&&typeof t.stack!=="undefined"){Q.push(t.stack)}else{Q.push("(no stack) "+t)}}function $(e){if(!G){return}var t=a(H,e);if(t!==-1){if(typeof process==="object"&&typeof process.emit==="function"){S.nextTick.runAfter(function(){var n=a(M,e);if(n!==-1){process.emit("rejectionHandled",Q[t],e);M.splice(n,1)}})}H.splice(t,1);Q.splice(t,1)}}S.resetUnhandledRejections=B;S.getUnhandledReasons=function(){return Q.slice()};S.stopUnhandledRejectionTracking=function(){B();G=false};B();S.reject=J;function J(e){var t=P({when:function(t){if(t){$(this)}return t?t(e):this}},function n(){return this},function r(){return{state:"rejected",reason:e}});F(t,e);return t}S.fulfill=X;function X(e){return P({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){if(t===null||t===void 0){return e.apply(void 0,n)}else{return e[t].apply(e,n)}},apply:function(t,n){return e.apply(t,n)},keys:function(){return h(e)}},void 0,function t(){return{state:"fulfilled",value:e}})}function V(e){var t=O();S.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}});return t.promise}S.master=z;function z(e){return P({isDef:function(){}},function t(n,r){return te(e,n,r)},function(){return S(e).inspect()})}S.spread=W;function W(e,t,n){return S(e).spread(t,n)}P.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)};S.async=K;function K(e){return function(){function t(e,t){var i;if(typeof StopIteration==="undefined"){try{i=n[e](t)}catch(u){return J(u)}if(i.done){return S(i.value)}else{return A(i.value,r,o)}}else{try{i=n[e](t)}catch(u){if(m(u)){return S(u.value)}else{return J(u)}}return A(i,r,o)}}var n=e.apply(this,arguments);var r=t.bind(t,"next");var o=t.bind(t,"throw");return r()}}S.spawn=Y;function Y(e){S.done(S.async(e)())}S["return"]=Z;function Z(e){throw new g(e)}S.promised=ee;function ee(e){return function(){return W([this,ne(arguments)],function(t,n){return e.apply(t,n)})}}S.dispatch=te;function te(e,t,n){return S(e).dispatch(t,n)}P.prototype.dispatch=function(e,t){var n=this;var r=O();S.nextTick(function(){n.promiseDispatch(r.resolve,e,t)});return r.promise};S.get=function(e,t){return S(e).dispatch("get",[t])};P.prototype.get=function(e){return this.dispatch("get",[e])};S.set=function(e,t,n){return S(e).dispatch("set",[t,n])};P.prototype.set=function(e,t){return this.dispatch("set",[e,t])};S.del=S["delete"]=function(e,t){return S(e).dispatch("delete",[t])};P.prototype.del=P.prototype["delete"]=function(e){return this.dispatch("delete",[e])};S.mapply=S.post=function(e,t,n){return S(e).dispatch("post",[t,n])};P.prototype.mapply=P.prototype.post=function(e,t){return this.dispatch("post",[e,t])};S.send=S.mcall=S.invoke=function(e,t){return S(e).dispatch("post",[t,f(arguments,2)])};P.prototype.send=P.prototype.mcall=P.prototype.invoke=function(e){return this.dispatch("post",[e,f(arguments,1)])};S.fapply=function(e,t){return S(e).dispatch("apply",[void 0,t])};P.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};S["try"]=S.fcall=function(e){return S(e).dispatch("apply",[void 0,f(arguments,1)])};P.prototype.fcall=function(){return this.dispatch("apply",[void 0,f(arguments)])};S.fbind=function(e){var t=S(e);var n=f(arguments,1);return function r(){return t.dispatch("apply",[this,n.concat(f(arguments))])}};P.prototype.fbind=function(){var e=this;var t=f(arguments);return function n(){return e.dispatch("apply",[this,t.concat(f(arguments))])}};S.keys=function(e){return S(e).dispatch("keys",[])};P.prototype.keys=function(){return this.dispatch("keys",[])};S.all=ne;function ne(e){return A(e,function(e){var t=0;var n=O();c(e,function(r,o,i){var u;if(U(o)&&(u=o.inspect()).state==="fulfilled"){e[i]=u.value}else{++t;A(o,function(r){e[i]=r;if(--t===0){n.resolve(e)}},n.reject,function(e){n.notify({index:i,value:e})})}},void 0);if(t===0){n.resolve(e)}return n.promise})}P.prototype.all=function(){return ne(this)};S.any=re;function re(e){if(e.length===0){return S.resolve()}var t=S.defer();var n=0;c(e,function(r,o,i){var u=e[i];n++;A(u,s,f,c);function s(e){t.resolve(e)}function f(){n--;if(n===0){t.reject(new Error("Can't get fulfillment value from any promise, all "+"promises were rejected."))}}function c(e){t.notify({index:i,value:e})}},undefined);return t.promise}P.prototype.any=function(){return re(this)};S.allResolved=E(oe,"allResolved","allSettled");function oe(e){return A(e,function(e){e=p(e,S);return A(ne(p(e,function(e){return A(e,o,o)})),function(){return e})})}P.prototype.allResolved=function(){return oe(this)};S.allSettled=ie;function ie(e){return S(e).allSettled()}P.prototype.allSettled=function(){return this.then(function(e){return ne(p(e,function(e){e=S(e);function t(){return e.inspect()}return e.then(t,t)}))})};S.fail=S["catch"]=function(e,t){return S(e).then(void 0,t)};P.prototype.fail=P.prototype["catch"]=function(e){return this.then(void 0,e)};S.progress=ue;function ue(e,t){return S(e).then(void 0,void 0,t)}P.prototype.progress=function(e){return this.then(void 0,void 0,e)};S.fin=S["finally"]=function(e,t){return S(e)["finally"](t)};P.prototype.fin=P.prototype["finally"]=function(e){e=S(e);return this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})};S.done=function(e,t,n,r){return S(e).done(t,n,r)};P.prototype.done=function(e,t,n){var r=function(e){S.nextTick(function(){w(e,o);if(S.onerror){S.onerror(e)}else{throw e}})};var o=e||t||n?this.then(e,t,n):this;if(typeof process==="object"&&process&&process.domain){r=process.domain.bind(r)}o.then(void 0,r)};S.timeout=function(e,t,n){return S(e).timeout(t,n)};P.prototype.timeout=function(e,t){var n=O();var r=setTimeout(function(){if(!t||"string"===typeof t){t=new Error(t||"Timed out after "+e+" ms");t.code="ETIMEDOUT"}n.reject(t)},e);this.then(function(e){clearTimeout(r);n.resolve(e)},function(e){clearTimeout(r);n.reject(e)},n.notify);return n.promise};S.delay=function(e,t){if(t===void 0){t=e;e=void 0}return S(e).delay(t)};P.prototype.delay=function(e){return this.then(function(t){var n=O();setTimeout(function(){n.resolve(t)},e);return n.promise})};S.nfapply=function(e,t){return S(e).nfapply(t)};P.prototype.nfapply=function(e){var t=O();var n=f(e);n.push(t.makeNodeResolver());this.fapply(n).fail(t.reject);return t.promise};S.nfcall=function(e){var t=f(arguments,1);return S(e).nfapply(t)};P.prototype.nfcall=function(){var e=f(arguments);var t=O();e.push(t.makeNodeResolver());this.fapply(e).fail(t.reject);return t.promise};S.nfbind=S.denodeify=function(e){var t=f(arguments,1);return function(){var n=t.concat(f(arguments));var r=O();n.push(r.makeNodeResolver());S(e).fapply(n).fail(r.reject);return r.promise}};P.prototype.nfbind=P.prototype.denodeify=function(){var e=f(arguments);e.unshift(this);return S.denodeify.apply(void 0,e)};S.nbind=function(e,t){var n=f(arguments,2);return function(){var r=n.concat(f(arguments));var o=O();r.push(o.makeNodeResolver());function i(){return e.apply(t,arguments)}S(i).fapply(r).fail(o.reject);return o.promise}};P.prototype.nbind=function(){var e=f(arguments,0);e.unshift(this);return S.nbind.apply(void 0,e)};S.nmapply=S.npost=function(e,t,n){return S(e).npost(t,n)};P.prototype.nmapply=P.prototype.npost=function(e,t){var n=f(t||[]);var r=O();n.push(r.makeNodeResolver());this.dispatch("post",[e,n]).fail(r.reject);return r.promise};S.nsend=S.nmcall=S.ninvoke=function(e,t){var n=f(arguments,2);var r=O();n.push(r.makeNodeResolver());S(e).dispatch("post",[t,n]).fail(r.reject);return r.promise};P.prototype.nsend=P.prototype.nmcall=P.prototype.ninvoke=function(e){var t=f(arguments,1);var n=O();t.push(n.makeNodeResolver());this.dispatch("post",[e,t]).fail(n.reject);return n.promise};S.nodeify=se;function se(e,t){return S(e).nodeify(t)}P.prototype.nodeify=function(e){if(e){this.then(function(t){S.nextTick(function(){e(null,t)})},function(t){S.nextTick(function(){e(t)})})}else{return this}};S.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var fe=R();return S});(function(){var e,t,n,r,o,i,u,s,f,c,a,p,l,d,h,y,v,m,g,k;d=typeof exports!=="undefined"&&exports!==null;v=d?exports:this;k="1.4.2";a="sup_member_auth";i="sup_member_open_id";s="sup_member_profile";l="sup_wx_open_sid";p="sup_wx_link";u="wx_open_sid";f=v.Q.noConflict();g={setParam:function(e,t){var n,r,o;e=encodeURIComponent(e);t=encodeURIComponent(t);o=document.location.search;n=e+"="+t;r=new RegExp("(&|\\?)"+e+"=[^&]*");o=o.replace(r,"$1"+n);if(!RegExp.$1){o+=(o.length>0?"&":"?")+n}document.location.search=o;return{key:e,value:t}},addParam:function(e,t){var n,r,o,i,u,s;if(typeof t!=="object"){return e}n=function(e,t,n){var r;r=e.indexOf("?")>-1?"&":"?";t=encodeURIComponent(t);n=encodeURIComponent(n);e=e+r+t+"="+n;return e};for(i in t){s=t[i];if(s!==null&&typeof s==="object"&&typeof s.length==="number"){for(o=0,u=s.length;o<u;o++){r=s[o];e=n(e,i,r)}}else{e=n(e,i,s)}}return e},getParam:function(e){var t,n,r,o,i,u;i={};o=window.location.search.substring(1);u=o.split("&");n=0;while(n<u.length){r=u[n].split("=");if(typeof i[r[0]]==="undefined"){i[r[0]]=decodeURIComponent(r[1])}else if(typeof i[r[0]]==="string"){t=[i[r[0]],decodeURIComponent(r[1])];i[r[0]]=t}else{i[r[0]].push(decodeURIComponent(r[1]))}n++}if(e){return i[e]}else{return i}},last_slash:function(e,t){if(!t){t="/"}return e.substring(e.lastIndexOf(t)+1,e.length)},isNode:function(e){if(typeof Node==="object"){return e instanceof Node}else if(e&&typeof e==="object"){return typeof e.nodeType==="number"&&typeof e.nodeName==="string"}else{return false}},isElement:function(e){if(typeof HTMLElement==="object"){return e instanceof HTMLElement}else if(e&&typeof e==="object"&&e!==null){return e.nodeType===1&&typeof e.nodeName==="string"}else{return false}}};v.Skipper=function(t){var n,r,o,c,d,h,y,v,w,b,T,j,x,R,E,S,O;v={contentType:"application/json",responseType:"json",withCredentials:false,expires:1e3*3600*24};x=function(e,t){var n,r,o,i,u,s;s=null;if(e[t]){s=e[t]}if(!s){n=document.documentElement;s=n.getAttribute(t)||n.dataset[t]}if(!h){u=document.getElementsByTagName("meta");for(r=0,o=u.length;r<o;r++){i=u[r];if(i.getAttribute("name")===t){s=i.getAttribute("content");break}}}return s};E=v;for(j in t){S=t[j];E[j]=S}r=x(E,"api_baseurl");h=x(E,"app_id");if(typeof r!=="string"||!r){throw"API missing!";return}if(typeof h!=="string"||!h){throw"App not found!";return}O=g.getParam(u);if(O){try{m.set(l,O,E.expires)}catch(T){b=T;console.error(b)}}else{O=m.get(l)}n=new e;w=function(e,t,r){var o;if(typeof e.headers!=="object"){e.headers={}}if(e.token){e.headers["Authorization"]="Bearer "+e.token}o=n.send({type:e.type,url:e.url,params:e.params,data:e.data,contentType:e.contentType||E.contentType,responseType:e.responseType||E.responseType,withCredentials:e.withCredentials||E.withCredentials,headers:e.headers});if(typeof t==="function"){o.then(function(e){var n;try{t(e)}catch(n){b=n;console.error(b)}return e})}if(typeof r==="function"){o["catch"](function(e){var t;try{r(e)}catch(t){b=t;console.error(b)}return e})}return o};y=function(){var e;try{m.remove(s);m.remove(a);m.remove(i);m.remove(l);return m.remove(p)}catch(e){b=e;return console.error(b)}};c=r+"/crm/entr/"+h+"/visitor";o=r+"/crm/entr/"+h+"/member";d=r+"/wx/link_member";R={request:function(e,t,n){return w(e,t,n)},login:function(e,t,n){return w({url:c+"/login",type:"POST",data:e},function(e){var n;try{m.set(a,e.token,E.expires);m.set(i,e.open_id,E.expires)}catch(n){b=n;console.error(b)}if(typeof t==="function"){return t(e)}},n)},logout:function(e,t){return w({url:o+"/logout",type:"GET",token:m.get(a)},function(t){y();if(typeof e==="function"){return e(t)}},function(e){y();if(typeof t==="function"){return t(data)}})},register:function(e,t,n){return w({url:c+"/register",type:"POST",data:e},t,n)},pwd:function(e,t,n){return w({url:o+"/update_pwd",type:"POST",data:e,token:m.get(a)},function(e){var n;try{m.set(a,e.token,E.expires)}catch(n){b=n;console.error(b)}if(typeof t==="function"){return t(e)}},n)},profile:{get:function(e,t){var n,r;r=m.get(s);if(r){n=f.defer();n.resolve(r);if(typeof e==="function"){n.promise.then(function(t){e(t);return t})}return n.promise}else{return w({url:o+"/profile",type:"GET",token:m.get(a)},function(t){var n;try{m.set(s,t,E.expires)}catch(n){b=n;console.error(b)}if(typeof e==="function"){return e(t)}},t)}},update:function(e,t,n){return w({url:o+"/profile",type:"PUT",data:e,token:m.get(a)},function(e){var n;try{m.set(s,e,E.expires)}catch(n){b=n;console.error(b)}if(typeof t==="function"){return t(e)}},n)},clean:function(){var e;try{m.remove(s);return true}catch(e){b=e;console.error(b);return false}}},parse_form:function(e){var t,n,r,o,i,u,s,f,c,a,p,l,d,h,y,v,m;try{n=e.action||e.getAttribute("action");n=g.last_slash(n).trim();if(typeof n!=="string"||!n){throw"Form action not found!"}u=e.querySelectorAll("[field]")}catch(s){b=s;console.error(b);return false}t=function(e){var t,n,r,o,i,u,s;i=e.getAttribute("name")||Date.now().toString();o=e.getAttribute("label")||i||"";n=e.getAttribute("field");if(n==="selector"){s=e.options[e.selectedIndex||0].value}else if(n==="multi-selector"){s=function(){var t,n,r,o;r=e.options;o=[];for(t=0,n=r.length;t<n;t++){u=r[t];if(u.selected){o.push(u.value||u.text)}}return o}()}else if(n==="radio"||n==="checkbox"){t=e.querySelectorAll(":checked");if(t.length>1){s=function(){var e,n,o;o=[];for(e=0,n=t.length;e<n;e++){r=t[e];o.push(r.value)}return o}()}else if(t.length===1){s=t[0].value}else{s=void 0}}else{s=e.value||e.text}return{name:i.trim(),label:o.trim(),value:s||""}};f=[];o=[];for(c=0,p=u.length;c<p;c++){i=u[c];r=t(i);v=e.querySelectorAll('[messages][for="'+r.name+'"], .messages[for="'+r.name+'"]');for(a=0,l=v.length;a<l;a++){y=v[a];y.style.display="none"}if(i.hasAttribute("required")&&r.value.length<=0){for(h=0,d=v.length;h<d;h++){y=v[h];y.style.display="block"}f.push(r)}o.push(r)}m=f.length>0?0:1;return{action:n,fields:m?o:f,status:m}},mailto:function(e,t){var n,r,o,i,u,s,f;e=e.split("?")[0].split("#")[0];if(e.toLowerCase().indexOf("mailto:")!==0){e="mailto:"+e}f="";i="";s=t||[];for(r=0,o=s.length;r<o;r++){n=s[r];if(n.name==="subject"){f=n.value}else{i=i+n.label+": "+n.value+"\n"}}i=encodeURIComponent(i)||"";u=e+"?subject="+f+"&body="+i;return u},demand:{free:function(e,t,n,r){var o,i,u,s,f,a;a="";i=[];f=t||[];for(u=0,s=f.length;u<s;u++){o=f[u];if(o.name==="subject"){a=o.value}else{i.push(o)}}return w({url:c+"/demand",type:"POST",data:{event_slug:e,subject:a,fields:i}},n,r)},query:function(e,t){return w({url:o+"/demand",type:"GET",token:m.get(a)},e,t)},create:function(e,t,n,r){var i,u,s,f,c,p;p="";u=[];c=t||[];for(s=0,f=c.length;s<f;s++){i=c[s];if(i.name==="subject"){p=i.value}else{u.push(i)}}return w({url:o+"/demand",type:"POST",data:{event_slug:e,subject:p,fields:u},token:m.get(a)},n,r)},remove:function(e,t,n){return w({url:o+"/demand/"+e,type:"DELETE",token:m.get(a)},t,n)}},wxlink:{open_sid:function(){return m.get(l)},login:function(e,t){O=m.get(l);return w({url:d+"/"+O,type:"GET"},function(t){var n,r;try{m.set(p,t,E.expires)}catch(n){b=n;console.error(b)}if(t.token){try{m.set(a,t.token,E.expires);m.set(i,t.open_id,E.expires)}catch(r){b=r;console.error(b)}}if(typeof e==="function"){return e(t)}},function(e){var n;try{m.remove(l)}catch(n){b=n;console.error(b)}if(typeof t==="function"){return t(e)}})},get:function(e,t){var n,r;r=m.get(p);if(r){n=f.defer();n.resolve(r);if(typeof e==="function"){n.promise.then(function(t){e(t);return t})}return n.promise}else{O=m.get(l);return w({url:d+"/"+O,type:"GET"},function(t){var n;try{m.set(p,t,E.expires)}catch(n){b=n;console.error(b)}if(typeof e==="function"){return e(t)}},function(e){var n;try{m.remove(l)}catch(n){b=n;console.error(b)}if(typeof t==="function"){return t(e)}})}},unlink:function(e,t){O=m.get(l);return w({url:d+"/"+O,type:"DELETE",token:m.get(a)},function(t){var n;try{m.remove(p)}catch(n){b=n;console.error(b)}if(typeof e==="function"){return e(t)}},t)},link:function(e,t){O=m.get(l);return w({url:d,type:"POST",data:{open_sid:O},token:m.get(a)},function(t){var n;try{m.set(p,t,E.expires)}catch(n){b=n;console.error(b)}if(typeof e==="function"){return e(t)}},t)},clean:function(){var e;try{m.remove(l);m.remove(p);return true}catch(e){b=e;console.error(b);return false}}},token:function(e){var t,n;if(e===null||e===false){try{m.remove(a)}catch(t){b=t;console.error(b);return false}}else if(e){try{m.set(a,e,E.expires)}catch(n){b=n;console.error(b);return false}}return m.get(a)},open_id:function(e){var t,n;if(e===null||e===false){try{m.remove(i)}catch(t){b=t;console.error(b);return false}}else if(e){try{m.set(i,e,E.expires)}catch(n){b=n;console.error(b);return false}}return m.get(i)},utils:g,version:k};return R};t=new Error("Request API is invaild.");o=new Error("Request Type is invaild.");n=new Error("Request Data is invaild.");r=new Error("Request Param is invaild.");c=new Error("Resource Not Found.");e=function(){var e,t,n;t={get:function(t){return e("GET",t)},post:function(t){return e("POST",t)},update:function(t){return e("PUT",t)},remove:function(t){return e("DELETE",t)},send:function(t){return e(t.type,t)}};e=function(e,t){var r,o,i,u,s,c,a,p,l,d;d=new XMLHttpRequest;p=g.addParam(t.url,t.params);d.open(e,p||"",true);d.responseType=t.responseType;d.withCredentials=Boolean(t.withCredentials);d.setRequestHeader("Content-Type",t.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");if(typeof t.headers==="object"){c=t.headers;for(u in c){l=c[u];d.setRequestHeader(u,l)}}r=f.defer();s=function(e){var t;d=this;if(d.readyState===d.DONE){d.removeEventListener("readystatechange",s);t=n(d);if(d.status>=200&&d.status<399){return r.resolve(t.data)}else{return r.reject(t)}}};d.addEventListener("readystatechange",s);if(e==="GET"||e==="DELETE"){d.send()}else{try{a=JSON.stringify(t.data||{})}catch(i){o=i;throw o}d.send(a)}return r.promise};n=function(e,t){var n,r,o,i;if(e.responseType==="json"){n=e.response}else if((r=e.responseType)==="blob"||r==="arraybuffer"){n=e.response}else if(e.responseType==="document"){n=e.responseXML}else if((o=e.responseType)===""||o==="text"){n=e.responseText}i={data:n,headers:e.getAllResponseHeaders(),status:e.status,statusText:e.statusText,responseType:e.responseType,responseURL:e.responseURL};return i};return t};y=function(e){var t;if(e==="undefined"){return void 0}if(e==="null"){return null}try{e=JSON.parse(e)}catch(t){e=e}return e};h=function(e){if(typeof e==="object"){e=JSON.stringify(e)}return e};m={set:function(e,t,n,r,o){var i;t=h(t);i=new Date;i.setTime(i.getTime()+n);n=n?"expires="+i.toUTCString()+"; ":"";r=r?"path="+r+"; ":"path=/; ";o=o?"domain="+o+"; ":"";return document.cookie=e+"="+t+"; "+n+o+r},get:function(e){var t,n,r,o,i;o=e+"=";n=document.cookie.split(";");r=0;while(r<n.length){t=n[r];while(t.charAt(0)===" "){t=t.substring(1)}if(t.indexOf(o)===0){i=t.substring(o.length,t.length);return y(i)}r++}return null},remove:function(e){var t,n,r;n="expires=Thu, 01 Jan 1970 00:00:00 UTC; ";r=r?"path="+r+"; ":"path=/; ";t=t?"domain="+t+"; ":"";return document.cookie=e+"=; "+n+t+r}}}).call(this);
